import React, { Component } from 'react'
import compose              from 'recompose/compose'
import lifecycle            from 'recompose/lifecycle'
import withHandlers         from 'recompose/withHandlers'
import withStateHandlers    from 'recompose/withStateHandlers'


import spaceRouter          from 'box/router/router/space/spaceRouter'
import withSpace            from 'evoke-me/space/all/withSpace'

import PageHome             from '../PageHome'


const enhance = compose(
  withSpace(spaceRouter),
  withStateHandlers(
    () => ({ isReady: false }),
    {
      isReadySet: () => (isReady) => ({ isReady }),
    }
  ),
  withHandlers({
    routerCreate: ({ fromRouter }) => async () => {
      await fromRouter.set({ path: `/`, component: PageHome })
    },
  }),
  lifecycle({
    async componentDidMount() {
      await this.props.routerCreate()

      this.props.isReadySet(true)
    }
  })
)

const BlockStart = enhance(({
  children = null,
  isReady,
}) => {
  return isReady ? children : null
})

export default BlockStart